<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Examples and Recipes • clock</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Examples and Recipes">
<meta property="og:description" content="clock">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">clock</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/faq.html">Frequently Asked Questions</a>
    </li>
    <li>
      <a href="../articles/recipes.html">Examples and Recipes</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DavisVaughan/clock/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="recipes_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Examples and Recipes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DavisVaughan/clock/blob/master/vignettes/recipes.Rmd"><code>vignettes/recipes.Rmd</code></a></small>
      <div class="hidden name"><code>recipes.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DavisVaughan/clock">clock</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></code></pre></div>
<p>This vignette shows common examples and recipes that might be useful when learning about clock. Where possible, both the high and low level API are shown.</p>
<p>Many of these examples are adapted from the date C++ library’s <a href="https://github.com/HowardHinnant/date/wiki/Examples-and-Recipes">Examples and Recipes</a> page.</p>
<div id="the-current-local-time" class="section level2">
<h2 class="hasAnchor">
<a href="#the-current-local-time" class="anchor"></a>The current local time</h2>
<p><code><a href="../reference/zoned_now.html">zoned_now()</a></code> returns the current time in a particular time zone. It will display up to nanosecond precision, but the exact amount is OS dependent (on a Mac this displays microsecond level information at nanosecond resolution).</p>
<p>Using <code>""</code> as the time zone string will try and use whatever R thinks your local time zone is (i.e. from <code><a href="https://rdrr.io/r/base/timezones.html">Sys.timezone()</a></code>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/zoned_now.html">zoned_now</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span>
<span class="co">#&gt; &lt;zoned_time&lt;nanosecond&gt;&lt;America/New_York (current)&gt;[1]&gt;</span>
<span class="co">#&gt; [1] "2021-02-10 15:54:29.875011000-05:00"</span></code></pre></div>
</div>
<div id="the-current-time-somewhere-else" class="section level2">
<h2 class="hasAnchor">
<a href="#the-current-time-somewhere-else" class="anchor"></a>The current time somewhere else</h2>
<p>Pass a time zone name to <code><a href="../reference/zoned_now.html">zoned_now()</a></code> to get the current time somewhere else.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/zoned_now.html">zoned_now</a></span><span class="op">(</span><span class="st">"Asia/Shanghai"</span><span class="op">)</span>
<span class="co">#&gt; &lt;zoned_time&lt;nanosecond&gt;&lt;Asia/Shanghai&gt;[1]&gt;</span>
<span class="co">#&gt; [1] "2021-02-11 04:54:29.875011000+08:00"</span></code></pre></div>
</div>
<div id="set-a-meeting-across-time-zones" class="section level2">
<h2 class="hasAnchor">
<a href="#set-a-meeting-across-time-zones" class="anchor"></a>Set a meeting across time zones</h2>
<p>Say you need to set a meeting with someone in Shanghai, but you live in New York. If you set a meeting for 9am, what time is that for them?</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">1</span>, <span class="fl">30</span>, <span class="fl">9</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/as_zoned.html">as_zoned</a></span><span class="op">(</span><span class="st">"America/New_York"</span><span class="op">)</span>

<span class="va">my_time</span>
<span class="co">#&gt; &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[1]&gt;</span>
<span class="co">#&gt; [1] "2019-01-30 09:00:00-05:00"</span>

<span class="va">their_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/zoned-zone.html">zoned_set_zone</a></span><span class="op">(</span><span class="va">my_time</span>, <span class="st">"Asia/Shanghai"</span><span class="op">)</span>

<span class="va">their_time</span>
<span class="co">#&gt; &lt;zoned_time&lt;second&gt;&lt;Asia/Shanghai&gt;[1]&gt;</span>
<span class="co">#&gt; [1] "2019-01-30 22:00:00+08:00"</span></code></pre></div>
<div id="high-level-api" class="section level3">
<h3 class="hasAnchor">
<a href="#high-level-api" class="anchor"></a>High level API</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">"2019-01-30 09:00:00"</span>, <span class="st">"America/New_York"</span><span class="op">)</span>

<span class="fu"><a href="../reference/date-zone.html">date_set_zone</a></span><span class="op">(</span><span class="va">my_time</span>, <span class="st">"Asia/Shanghai"</span><span class="op">)</span>
<span class="co">#&gt; [1] "2019-01-30 22:00:00 CST"</span></code></pre></div>
</div>
</div>
<div id="force-a-specific-time-zone" class="section level2">
<h2 class="hasAnchor">
<a href="#force-a-specific-time-zone" class="anchor"></a>Force a specific time zone</h2>
<p>Say your co-worker in Shanghai (from the last example) accidentally logged on at 9am <em>their time</em>. What time would this be for you?</p>
<p>The first step to solve this is to force <code>my_time</code> to have the same printed time, but use the Asia/Shanghai time zone. You can do this by going through naive-time:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">1</span>, <span class="fl">30</span>, <span class="fl">9</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/as_zoned.html">as_zoned</a></span><span class="op">(</span><span class="st">"America/New_York"</span><span class="op">)</span>

<span class="va">my_time</span>
<span class="co">#&gt; &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[1]&gt;</span>
<span class="co">#&gt; [1] "2019-01-30 09:00:00-05:00"</span>

<span class="co"># Drop the time zone information, retaining the printed time</span>
<span class="va">my_time</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; &lt;time_point&lt;naive&gt;&lt;second&gt;[1]&gt;</span>
<span class="co">#&gt; [1] "2019-01-30 09:00:00"</span>

<span class="co"># Add the correct time zone name back on,</span>
<span class="co"># again retaining the printed time</span>
<span class="va">their_9am</span> <span class="op">&lt;-</span> <span class="va">my_time</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/as_zoned.html">as_zoned</a></span><span class="op">(</span><span class="st">"Asia/Shanghai"</span><span class="op">)</span>

<span class="va">their_9am</span>
<span class="co">#&gt; &lt;zoned_time&lt;second&gt;&lt;Asia/Shanghai&gt;[1]&gt;</span>
<span class="co">#&gt; [1] "2019-01-30 09:00:00+08:00"</span></code></pre></div>
<p>Note that a conversion like this isn’t always possible due to daylight saving time issues, in which case you might need to set the <code>nonexistent</code> and <code>ambiguous</code> arguments of <code><a href="../reference/as_zoned.html">as_zoned()</a></code>.</p>
<p>What time would this have been for you in New York?</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/zoned-zone.html">zoned_set_zone</a></span><span class="op">(</span><span class="va">their_9am</span>, <span class="st">"America/New_York"</span><span class="op">)</span>
<span class="co">#&gt; &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[1]&gt;</span>
<span class="co">#&gt; [1] "2019-01-29 20:00:00-05:00"</span></code></pre></div>
<div id="high-level-api-1" class="section level3">
<h3 class="hasAnchor">
<a href="#high-level-api-1" class="anchor"></a>High level API</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">"2019-01-30 09:00:00"</span>, <span class="st">"America/New_York"</span><span class="op">)</span>

<span class="va">my_time</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">"Asia/Shanghai"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/date-zone.html">date_set_zone</a></span><span class="op">(</span><span class="st">"America/New_York"</span><span class="op">)</span>
<span class="co">#&gt; [1] "2019-01-29 20:00:00 EST"</span></code></pre></div>
</div>
</div>
<div id="finding-the-next-monday-or-thursday" class="section level2">
<h2 class="hasAnchor">
<a href="#finding-the-next-monday-or-thursday" class="anchor"></a>Finding the next Monday (or Thursday)</h2>
<p>Given a particular day precision naive-time, how can you compute the next Monday? This is very easily accomplished with <code><a href="../reference/time_point_shift.html">time_point_shift()</a></code>. It takes a time point vector and a “target” weekday, and shifts the time points to that target weekday.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">days</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="co"># A Tuesday and a Friday</span>
<span class="fu"><a href="../reference/as_weekday.html">as_weekday</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span>
<span class="co">#&gt; &lt;weekday[2]&gt;</span>
<span class="co">#&gt; [1] Tue Fri</span>

<span class="va">monday</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weekday.html">weekday</a></span><span class="op">(</span><span class="va">clock_weekdays</span><span class="op">$</span><span class="va">monday</span><span class="op">)</span>

<span class="fu"><a href="../reference/time_point_shift.html">time_point_shift</a></span><span class="op">(</span><span class="va">days</span>, <span class="va">monday</span><span class="op">)</span>
<span class="co">#&gt; &lt;time_point&lt;naive&gt;&lt;day&gt;[2]&gt;</span>
<span class="co">#&gt; [1] "2019-01-07" "2019-02-04"</span>

<span class="fu"><a href="../reference/as_weekday.html">as_weekday</a></span><span class="op">(</span><span class="fu"><a href="../reference/time_point_shift.html">time_point_shift</a></span><span class="op">(</span><span class="va">days</span>, <span class="va">monday</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; &lt;weekday[2]&gt;</span>
<span class="co">#&gt; [1] Mon Mon</span></code></pre></div>
<p>You can also shift to the previous instance of the target weekday:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/time_point_shift.html">time_point_shift</a></span><span class="op">(</span><span class="va">days</span>, <span class="va">monday</span>, which <span class="op">=</span> <span class="st">"previous"</span><span class="op">)</span>
<span class="co">#&gt; &lt;time_point&lt;naive&gt;&lt;day&gt;[2]&gt;</span>
<span class="co">#&gt; [1] "2018-12-31" "2019-01-28"</span></code></pre></div>
<p>If you happen to already be on the target weekday, the default behavior returns the input unchanged. However, you can also chose to advance to the next instance of the target.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tuesday</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weekday.html">weekday</a></span><span class="op">(</span><span class="va">clock_weekdays</span><span class="op">$</span><span class="va">tuesday</span><span class="op">)</span>

<span class="fu"><a href="../reference/time_point_shift.html">time_point_shift</a></span><span class="op">(</span><span class="va">days</span>, <span class="va">tuesday</span><span class="op">)</span>
<span class="co">#&gt; &lt;time_point&lt;naive&gt;&lt;day&gt;[2]&gt;</span>
<span class="co">#&gt; [1] "2019-01-01" "2019-02-05"</span>
<span class="fu"><a href="../reference/time_point_shift.html">time_point_shift</a></span><span class="op">(</span><span class="va">days</span>, <span class="va">tuesday</span>, boundary <span class="op">=</span> <span class="st">"advance"</span><span class="op">)</span>
<span class="co">#&gt; &lt;time_point&lt;naive&gt;&lt;day&gt;[2]&gt;</span>
<span class="co">#&gt; [1] "2019-01-08" "2019-02-05"</span></code></pre></div>
<p>While <code><a href="../reference/time_point_shift.html">time_point_shift()</a></code> is built in to clock, it can be useful to discuss the arithmetic going on in the underlying weekday type which powers this function. To do so, we will build some parts of <code><a href="../reference/time_point_shift.html">time_point_shift()</a></code> from scratch.</p>
<p>The weekday type represents a single day of the week and implements <em>circular arithmetic</em>. Let’s see the code for a simple version of <code><a href="../reference/time_point_shift.html">time_point_shift()</a></code> that just shifts to the next target weekday:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">next_weekday</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">target</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">x</span> <span class="op">+</span> <span class="op">(</span><span class="va">target</span> <span class="op">-</span> <span class="fu"><a href="../reference/as_weekday.html">as_weekday</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu">next_weekday</span><span class="op">(</span><span class="va">days</span>, <span class="va">monday</span><span class="op">)</span>
<span class="co">#&gt; &lt;time_point&lt;naive&gt;&lt;day&gt;[2]&gt;</span>
<span class="co">#&gt; [1] "2019-01-07" "2019-02-04"</span>

<span class="fu"><a href="../reference/as_weekday.html">as_weekday</a></span><span class="op">(</span><span class="fu">next_weekday</span><span class="op">(</span><span class="va">days</span>, <span class="va">monday</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; &lt;weekday[2]&gt;</span>
<span class="co">#&gt; [1] Mon Mon</span></code></pre></div>
<p>Let’s break down how <code>next_weekday()</code> works. The first step takes the difference between two weekday vectors. It does this using circular arithmetic. Once we get passed the 7th day of the week (whatever that may be), it wraps back around to the 1st day of the week. Implementing weekday arithmetic in this way means that the following nicely returns the number of days until the next Monday as a day based duration:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">monday</span> <span class="op">-</span> <span class="fu"><a href="../reference/as_weekday.html">as_weekday</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span>
<span class="co">#&gt; &lt;duration&lt;day&gt;[2]&gt;</span>
<span class="co">#&gt; [1] 6 3</span></code></pre></div>
<p>Which can be added to our day precision <code>days</code> vector to get the date of the next Monday:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">days</span> <span class="op">+</span> <span class="op">(</span><span class="va">monday</span> <span class="op">-</span> <span class="fu"><a href="../reference/as_weekday.html">as_weekday</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; &lt;time_point&lt;naive&gt;&lt;day&gt;[2]&gt;</span>
<span class="co">#&gt; [1] "2019-01-07" "2019-02-04"</span></code></pre></div>
<p>The current implementation will return the input if it is already on the target weekday. To use the <code>boundary = "advance"</code> behavior, you could implement <code>next_weekday()</code> as:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">next_weekday2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">target</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="../reference/duration-helper.html">duration_days</a></span><span class="op">(</span><span class="fl">1L</span><span class="op">)</span>
  <span class="va">x</span> <span class="op">+</span> <span class="op">(</span><span class="va">target</span> <span class="op">-</span> <span class="fu"><a href="../reference/as_weekday.html">as_weekday</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">a_monday</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2018</span>, <span class="fl">12</span>, <span class="fl">31</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/as_weekday.html">as_weekday</a></span><span class="op">(</span><span class="va">a_monday</span><span class="op">)</span>
<span class="co">#&gt; &lt;weekday[1]&gt;</span>
<span class="co">#&gt; [1] Mon</span>

<span class="fu">next_weekday2</span><span class="op">(</span><span class="va">a_monday</span>, <span class="va">monday</span><span class="op">)</span>
<span class="co">#&gt; &lt;time_point&lt;naive&gt;&lt;day&gt;[1]&gt;</span>
<span class="co">#&gt; [1] "2019-01-07"</span></code></pre></div>
<div id="high-level-api-2" class="section level3">
<h3 class="hasAnchor">
<a href="#high-level-api-2" class="anchor"></a>High level API</h3>
<p>In the high level API, you can use <code><a href="../reference/date-and-date-time-shifting.html">date_shift()</a></code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">monday</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weekday.html">weekday</a></span><span class="op">(</span><span class="va">clock_weekdays</span><span class="op">$</span><span class="va">monday</span><span class="op">)</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2019-01-01"</span>, <span class="st">"2019-02-01"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/date-and-date-time-shifting.html">date_shift</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">monday</span><span class="op">)</span>
<span class="co">#&gt; [1] "2019-01-07" "2019-02-04"</span>

<span class="co"># With a date-time</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2019-01-01 02:30:30"</span>, <span class="st">"2019-02-01 05:20:22"</span><span class="op">)</span>, 
  <span class="st">"America/New_York"</span>
<span class="op">)</span>

<span class="fu"><a href="../reference/date-and-date-time-shifting.html">date_shift</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">monday</span><span class="op">)</span>
<span class="co">#&gt; [1] "2019-01-07 02:30:30 EST" "2019-02-04 05:20:22 EST"</span></code></pre></div>
<p>Note that adding weekdays to a POSIXct could generate nonexistent or ambiguous times due to daylight saving time, which would have to be handled by supplying <code>nonexistent</code> and <code>ambiguous</code> arguments to <code><a href="../reference/date-and-date-time-shifting.html">date_shift()</a></code>.</p>
</div>
</div>
<div id="generate-sequences-of-dates-and-date-times" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-sequences-of-dates-and-date-times" class="anchor"></a>Generate sequences of dates and date-times</h2>
<p>clock implements S3 methods for the <code><a href="https://rdrr.io/r/base/seq.html">seq()</a></code> generic function for the calendar and time point types it provides. The precision that you can generate sequences for depends on the type.</p>
<ul>
<li>year-month-day: Yearly or monthly sequences</li>
<li>year-quarter-day: Yearly or quarterly sequences</li>
<li>sys-time / naive-time: Weekly, Daily, Hourly, …, Subsecond sequences</li>
</ul>
<p>When generating sequences, the type and precision of <code>from</code> determine the result. For example:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ym</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">1</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">ym</span>
<span class="co">#&gt; &lt;year_month_day&lt;month&gt;[invalid=0][10]&gt;</span>
<span class="co">#&gt;  [1] "2019-01" "2019-03" "2019-05" "2019-07" "2019-09" "2019-11" "2020-01"</span>
<span class="co">#&gt;  [8] "2020-03" "2020-05" "2020-07"</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">yq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="../reference/year_quarter_day.html">year_quarter_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">1</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>This allows you to generate sequences of year-months or year-quarters without having to worry about the day of the month/quarter becoming invalid. You can set the day of the results to get to a day precision calendar. For example, to get the last days of the month/quarter for this sequence:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/clock-setters.html">set_day</a></span><span class="op">(</span><span class="va">ym</span>, <span class="st">"last"</span><span class="op">)</span>
<span class="co">#&gt; &lt;year_month_day&lt;day&gt;[invalid=0][10]&gt;</span>
<span class="co">#&gt;  [1] "2019-01-31" "2019-03-31" "2019-05-31" "2019-07-31" "2019-09-30"</span>
<span class="co">#&gt;  [6] "2019-11-30" "2020-01-31" "2020-03-31" "2020-05-31" "2020-07-31"</span>

<span class="fu"><a href="../reference/clock-setters.html">set_day</a></span><span class="op">(</span><span class="va">yq</span>, <span class="st">"last"</span><span class="op">)</span>
<span class="co">#&gt; &lt;year_quarter_day&lt;January&gt;&lt;day&gt;[invalid=0][10]&gt;</span>
<span class="co">#&gt;  [1] "2019-Q1-90" "2019-Q3-92" "2020-Q1-91" "2020-Q3-92" "2021-Q1-90"</span>
<span class="co">#&gt;  [6] "2021-Q3-92" "2022-Q1-90" "2022-Q3-92" "2023-Q1-90" "2023-Q3-92"</span></code></pre></div>
<p>You won’t be able to generate day precision sequences with calendars. Instead, you should use a time point.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">from</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">to</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">5</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">from</span>, <span class="va">to</span>, by <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>
<span class="co">#&gt; &lt;time_point&lt;naive&gt;&lt;day&gt;[7]&gt;</span>
<span class="co">#&gt; [1] "2019-01-01" "2019-01-21" "2019-02-10" "2019-03-02" "2019-03-22"</span>
<span class="co">#&gt; [6] "2019-04-11" "2019-05-01"</span></code></pre></div>
<p>If you use an integer <code>by</code> value, it is interpreted as a duration at the same precision as <code>from</code>. You can also use a duration object that can be cast to the same precision as <code>from</code>. For example, to generate a sequence spaced out by 90 minutes for these second precision end points:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">from</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">30</span>, <span class="fl">00</span><span class="op">)</span><span class="op">)</span>
<span class="va">to</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">12</span>, <span class="fl">30</span>, <span class="fl">00</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">from</span>, <span class="va">to</span>, by <span class="op">=</span> <span class="fu"><a href="../reference/duration-helper.html">duration_minutes</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; &lt;time_point&lt;naive&gt;&lt;second&gt;[7]&gt;</span>
<span class="co">#&gt; [1] "2019-01-01 02:30:00" "2019-01-01 04:00:00" "2019-01-01 05:30:00"</span>
<span class="co">#&gt; [4] "2019-01-01 07:00:00" "2019-01-01 08:30:00" "2019-01-01 10:00:00"</span>
<span class="co">#&gt; [7] "2019-01-01 11:30:00"</span></code></pre></div>
</div>
<div id="grouping-by-months-or-quarters" class="section level2">
<h2 class="hasAnchor">
<a href="#grouping-by-months-or-quarters" class="anchor"></a>Grouping by months or quarters</h2>
<p>When working on a data analysis, you might be required to summarize certain metrics at a monthly or quarterly level. With <code><a href="../reference/calendar_group.html">calendar_group()</a></code>, you can easily summarize at the granular precision that you care about. Take this vector of day precision naive-times in 2019:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">from</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">to</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">12</span>, <span class="fl">31</span><span class="op">)</span><span class="op">)</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">from</span>, <span class="va">to</span>, by <span class="op">=</span> <span class="fu"><a href="../reference/duration-helper.html">duration_days</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span>

<span class="va">x</span>
<span class="co">#&gt; &lt;time_point&lt;naive&gt;&lt;day&gt;[19]&gt;</span>
<span class="co">#&gt;  [1] "2019-01-01" "2019-01-21" "2019-02-10" "2019-03-02" "2019-03-22"</span>
<span class="co">#&gt;  [6] "2019-04-11" "2019-05-01" "2019-05-21" "2019-06-10" "2019-06-30"</span>
<span class="co">#&gt; [11] "2019-07-20" "2019-08-09" "2019-08-29" "2019-09-18" "2019-10-08"</span>
<span class="co">#&gt; [16] "2019-10-28" "2019-11-17" "2019-12-07" "2019-12-27"</span></code></pre></div>
<p>To group by month, first convert to a year-month-day:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ymd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_year_month_day.html">as_year_month_day</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ymd</span><span class="op">)</span>
<span class="co">#&gt; &lt;year_month_day&lt;day&gt;[invalid=0][6]&gt;</span>
<span class="co">#&gt; [1] "2019-01-01" "2019-01-21" "2019-02-10" "2019-03-02" "2019-03-22"</span>
<span class="co">#&gt; [6] "2019-04-11"</span>

<span class="fu"><a href="../reference/calendar_group.html">calendar_group</a></span><span class="op">(</span><span class="va">ymd</span>, <span class="st">"month"</span><span class="op">)</span>
<span class="co">#&gt; &lt;year_month_day&lt;month&gt;[invalid=0][19]&gt;</span>
<span class="co">#&gt;  [1] "2019-01" "2019-01" "2019-02" "2019-03" "2019-03" "2019-04" "2019-05"</span>
<span class="co">#&gt;  [8] "2019-05" "2019-06" "2019-06" "2019-07" "2019-08" "2019-08" "2019-09"</span>
<span class="co">#&gt; [15] "2019-10" "2019-10" "2019-11" "2019-12" "2019-12"</span></code></pre></div>
<p>To group by quarter, convert to a year-quarter-day:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">yqd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_year_quarter_day.html">as_year_quarter_day</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">yqd</span><span class="op">)</span>
<span class="co">#&gt; &lt;year_quarter_day&lt;January&gt;&lt;day&gt;[invalid=0][6]&gt;</span>
<span class="co">#&gt; [1] "2019-Q1-01" "2019-Q1-21" "2019-Q1-41" "2019-Q1-61" "2019-Q1-81"</span>
<span class="co">#&gt; [6] "2019-Q2-11"</span>

<span class="fu"><a href="../reference/calendar_group.html">calendar_group</a></span><span class="op">(</span><span class="va">yqd</span>, <span class="st">"quarter"</span><span class="op">)</span>
<span class="co">#&gt; &lt;year_quarter_day&lt;January&gt;&lt;quarter&gt;[invalid=0][19]&gt;</span>
<span class="co">#&gt;  [1] "2019-Q1" "2019-Q1" "2019-Q1" "2019-Q1" "2019-Q1" "2019-Q2" "2019-Q2"</span>
<span class="co">#&gt;  [8] "2019-Q2" "2019-Q2" "2019-Q2" "2019-Q3" "2019-Q3" "2019-Q3" "2019-Q3"</span>
<span class="co">#&gt; [15] "2019-Q4" "2019-Q4" "2019-Q4" "2019-Q4" "2019-Q4"</span></code></pre></div>
<p>If you need to group by a multiple of months / quarters, you can do that too:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calendar_group.html">calendar_group</a></span><span class="op">(</span><span class="va">ymd</span>, <span class="st">"month"</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; &lt;year_month_day&lt;month&gt;[invalid=0][19]&gt;</span>
<span class="co">#&gt;  [1] "2019-01" "2019-01" "2019-01" "2019-03" "2019-03" "2019-03" "2019-05"</span>
<span class="co">#&gt;  [8] "2019-05" "2019-05" "2019-05" "2019-07" "2019-07" "2019-07" "2019-09"</span>
<span class="co">#&gt; [15] "2019-09" "2019-09" "2019-11" "2019-11" "2019-11"</span>

<span class="fu"><a href="../reference/calendar_group.html">calendar_group</a></span><span class="op">(</span><span class="va">yqd</span>, <span class="st">"quarter"</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; &lt;year_quarter_day&lt;January&gt;&lt;quarter&gt;[invalid=0][19]&gt;</span>
<span class="co">#&gt;  [1] "2019-Q1" "2019-Q1" "2019-Q1" "2019-Q1" "2019-Q1" "2019-Q1" "2019-Q1"</span>
<span class="co">#&gt;  [8] "2019-Q1" "2019-Q1" "2019-Q1" "2019-Q3" "2019-Q3" "2019-Q3" "2019-Q3"</span>
<span class="co">#&gt; [15] "2019-Q3" "2019-Q3" "2019-Q3" "2019-Q3" "2019-Q3"</span></code></pre></div>
<p>Note that the returned calendar vector is at the precision we grouped by, not at the original precision with, say, the day of the month / quarter set to <code>1</code>.</p>
<p>Additionally, be aware that <code><a href="../reference/calendar_group.html">calendar_group()</a></code> groups “within” the component that is one unit of precision larger than the <code>precision</code> you specify. So, when grouping by <code>"day"</code>, this groups by “day of the month”, which can’t cross the month or year boundary. If you need to bundle dates together by something like 60 days (i.e. crossing the month boundary), then you should use <code><a href="../reference/time-point-rounding.html">time_point_floor()</a></code>.</p>
<div id="high-level-api-3" class="section level3">
<h3 class="hasAnchor">
<a href="#high-level-api-3" class="anchor"></a>High level API</h3>
<p>In the high level API, you can use <code><a href="../reference/date_group.html">date_group()</a></code> to group Date vectors by one of their 3 components: year, month, or day. Since month precision dates can’t be represented with Date vectors, <code><a href="../reference/date_group.html">date_group()</a></code> sets the day of the month to 1.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2019-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2019-12-31"</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>

<span class="fu"><a href="../reference/date_group.html">date_group</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"month"</span><span class="op">)</span>
<span class="co">#&gt;  [1] "2019-01-01" "2019-01-01" "2019-02-01" "2019-03-01" "2019-03-01"</span>
<span class="co">#&gt;  [6] "2019-04-01" "2019-05-01" "2019-05-01" "2019-06-01" "2019-06-01"</span>
<span class="co">#&gt; [11] "2019-07-01" "2019-08-01" "2019-08-01" "2019-09-01" "2019-10-01"</span>
<span class="co">#&gt; [16] "2019-10-01" "2019-11-01" "2019-12-01" "2019-12-01"</span></code></pre></div>
<p>You won’t be able to group by <code>"quarter"</code>, since this isn’t one of the 3 components that the high level API lets you work with. Instead, this is a case where you should convert to a year-quarter-day, group on that type, then convert back to Date.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/as_year_quarter_day.html">as_year_quarter_day</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/calendar_group.html">calendar_group</a></span><span class="op">(</span><span class="st">"quarter"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/clock-setters.html">set_day</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;  [1] "2019-01-01" "2019-01-01" "2019-01-01" "2019-01-01" "2019-01-01"</span>
<span class="co">#&gt;  [6] "2019-04-01" "2019-04-01" "2019-04-01" "2019-04-01" "2019-04-01"</span>
<span class="co">#&gt; [11] "2019-07-01" "2019-07-01" "2019-07-01" "2019-07-01" "2019-10-01"</span>
<span class="co">#&gt; [16] "2019-10-01" "2019-10-01" "2019-10-01" "2019-10-01"</span></code></pre></div>
<p>This is actually equivalent to <code><a href="../reference/date_group.html">date_group(x, "month", n = 3)</a></code>. If your fiscal year starts in January, you can use that instead. However, if your fiscal year starts in a different month, say, June, you’ll need to use the approach from above like so:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/as_year_quarter_day.html">as_year_quarter_day</a></span><span class="op">(</span>start <span class="op">=</span> <span class="va">clock_months</span><span class="op">$</span><span class="va">june</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/calendar_group.html">calendar_group</a></span><span class="op">(</span><span class="st">"quarter"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/clock-setters.html">set_day</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;  [1] "2018-12-01" "2018-12-01" "2018-12-01" "2019-03-01" "2019-03-01"</span>
<span class="co">#&gt;  [6] "2019-03-01" "2019-03-01" "2019-03-01" "2019-06-01" "2019-06-01"</span>
<span class="co">#&gt; [11] "2019-06-01" "2019-06-01" "2019-06-01" "2019-09-01" "2019-09-01"</span>
<span class="co">#&gt; [16] "2019-09-01" "2019-09-01" "2019-12-01" "2019-12-01"</span></code></pre></div>
</div>
</div>
<div id="flooring-by-days" class="section level2">
<h2 class="hasAnchor">
<a href="#flooring-by-days" class="anchor"></a>Flooring by days</h2>
<p>While <code><a href="../reference/calendar_group.html">calendar_group()</a></code> can group by “component”, it isn’t useful for bundling together sets of time points that can cross month/year boundaries, like “60 days” of data. For that, you are better off <em>flooring</em> by rolling sets of 60 days.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">from</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">to</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">12</span>, <span class="fl">31</span><span class="op">)</span><span class="op">)</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">from</span>, <span class="va">to</span>, by <span class="op">=</span> <span class="fu"><a href="../reference/duration-helper.html">duration_days</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/time-point-rounding.html">time_point_floor</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"day"</span>, n <span class="op">=</span> <span class="fl">60</span><span class="op">)</span>
<span class="co">#&gt; &lt;time_point&lt;naive&gt;&lt;day&gt;[19]&gt;</span>
<span class="co">#&gt;  [1] "2018-12-15" "2018-12-15" "2018-12-15" "2019-02-13" "2019-02-13"</span>
<span class="co">#&gt;  [6] "2019-02-13" "2019-04-14" "2019-04-14" "2019-04-14" "2019-06-13"</span>
<span class="co">#&gt; [11] "2019-06-13" "2019-06-13" "2019-08-12" "2019-08-12" "2019-08-12"</span>
<span class="co">#&gt; [16] "2019-10-11" "2019-10-11" "2019-10-11" "2019-12-10"</span></code></pre></div>
<p>Flooring operates on the underlying duration, which for day precision time points is a count of days since the <em>origin</em>, 1970-01-01.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; $ticks</span>
<span class="co">#&gt; [1] 17897</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"clock")</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; attr(,"precision")</span>
<span class="co">#&gt; [1] 4</span></code></pre></div>
<p>The 60 day counter starts here, which means that any times between <code>[1970-01-01, 1970-03-02)</code> are all floored to 1970-01-01. At <code>1970-03-02</code>, the counter starts again.</p>
<p>If you would like to change this origin, you can provide a time point to start counting from with the <code>origin</code> argument. This is mostly useful if you are flooring by weeks and you want to change the day of the week that the count starts on. Since 1970-01-01 is a Thursday, flooring by 14 days defaults to returning all Thursdays.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">3</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">x</span>
<span class="co">#&gt; &lt;time_point&lt;naive&gt;&lt;day&gt;[10]&gt;</span>
<span class="co">#&gt;  [1] "2019-01-01" "2019-01-04" "2019-01-07" "2019-01-10" "2019-01-13"</span>
<span class="co">#&gt;  [6] "2019-01-16" "2019-01-19" "2019-01-22" "2019-01-25" "2019-01-28"</span>

<span class="va">thursdays</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/time-point-rounding.html">time_point_floor</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"day"</span>, n <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>
<span class="va">thursdays</span>
<span class="co">#&gt; &lt;time_point&lt;naive&gt;&lt;day&gt;[10]&gt;</span>
<span class="co">#&gt;  [1] "2018-12-27" "2018-12-27" "2018-12-27" "2019-01-10" "2019-01-10"</span>
<span class="co">#&gt;  [6] "2019-01-10" "2019-01-10" "2019-01-10" "2019-01-24" "2019-01-24"</span>

<span class="fu"><a href="../reference/as_weekday.html">as_weekday</a></span><span class="op">(</span><span class="va">thursdays</span><span class="op">)</span>
<span class="co">#&gt; &lt;weekday[10]&gt;</span>
<span class="co">#&gt;  [1] Thu Thu Thu Thu Thu Thu Thu Thu Thu Thu</span></code></pre></div>
<p>You can use <code>origin</code> to change this to floor to Mondays.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">origin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2018</span>, <span class="fl">12</span>, <span class="fl">31</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/as_weekday.html">as_weekday</a></span><span class="op">(</span><span class="va">origin</span><span class="op">)</span>
<span class="co">#&gt; &lt;weekday[1]&gt;</span>
<span class="co">#&gt; [1] Mon</span>

<span class="va">mondays</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/time-point-rounding.html">time_point_floor</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"day"</span>, n <span class="op">=</span> <span class="fl">14</span>, origin <span class="op">=</span> <span class="va">origin</span><span class="op">)</span>
<span class="va">mondays</span>
<span class="co">#&gt; &lt;time_point&lt;naive&gt;&lt;day&gt;[10]&gt;</span>
<span class="co">#&gt;  [1] "2018-12-31" "2018-12-31" "2018-12-31" "2018-12-31" "2018-12-31"</span>
<span class="co">#&gt;  [6] "2019-01-14" "2019-01-14" "2019-01-14" "2019-01-14" "2019-01-28"</span>

<span class="fu"><a href="../reference/as_weekday.html">as_weekday</a></span><span class="op">(</span><span class="va">mondays</span><span class="op">)</span>
<span class="co">#&gt; &lt;weekday[10]&gt;</span>
<span class="co">#&gt;  [1] Mon Mon Mon Mon Mon Mon Mon Mon Mon Mon</span></code></pre></div>
<div id="high-level-api-4" class="section level3">
<h3 class="hasAnchor">
<a href="#high-level-api-4" class="anchor"></a>High level API</h3>
<p>You can use <code><a href="../reference/date-and-date-time-rounding.html">date_floor()</a></code> with Date and POSIXct types.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2019-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2019-12-31"</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>

<span class="fu"><a href="../reference/date-and-date-time-rounding.html">date_floor</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"day"</span>, n <span class="op">=</span> <span class="fl">60</span><span class="op">)</span>
<span class="co">#&gt;  [1] "2018-12-15" "2018-12-15" "2018-12-15" "2019-02-13" "2019-02-13"</span>
<span class="co">#&gt;  [6] "2019-02-13" "2019-04-14" "2019-04-14" "2019-04-14" "2019-06-13"</span>
<span class="co">#&gt; [11] "2019-06-13" "2019-06-13" "2019-08-12" "2019-08-12" "2019-08-12"</span>
<span class="co">#&gt; [16] "2019-10-11" "2019-10-11" "2019-10-11" "2019-12-10"</span></code></pre></div>
<p>The <code>origin</code> you provide should be another Date. For week precision flooring with Dates, you can specify <code>"week"</code> as the precision.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2019-01-01"</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">3</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="va">origin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2018-12-31"</span><span class="op">)</span>

<span class="fu"><a href="../reference/date-and-date-time-rounding.html">date_floor</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"week"</span>, n <span class="op">=</span> <span class="fl">2</span>, origin <span class="op">=</span> <span class="va">origin</span><span class="op">)</span>
<span class="co">#&gt;  [1] "2018-12-31" "2018-12-31" "2018-12-31" "2018-12-31" "2018-12-31"</span>
<span class="co">#&gt;  [6] "2019-01-14" "2019-01-14" "2019-01-14" "2019-01-14" "2019-01-28"</span></code></pre></div>
</div>
</div>
<div id="day-of-the-year" class="section level2">
<h2 class="hasAnchor">
<a href="#day-of-the-year" class="anchor"></a>Day of the year</h2>
<p>There is currently no year-day calendar type in clock. That said, you can still compute the day of the year using a helper like:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="va">clock_months</span><span class="op">$</span><span class="va">july</span>, <span class="fl">4</span><span class="op">)</span>

<span class="va">day_of_year</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">year</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clock-getters.html">get_year</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="va">first</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="va">year</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>
  <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="../reference/as_naive.html">as_naive</a></span><span class="op">(</span><span class="va">first</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/duration-helper.html">duration_days</a></span><span class="op">(</span><span class="fl">1L</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu">day_of_year</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; &lt;duration&lt;day&gt;[1]&gt;</span>
<span class="co">#&gt; [1] 185</span></code></pre></div>
<div id="high-level-api-5" class="section level3">
<h3 class="hasAnchor">
<a href="#high-level-api-5" class="anchor"></a>High level API</h3>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2019-07-04"</span><span class="op">)</span>

<span class="va">day_of_year</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">year</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clock-getters.html">get_year</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="va">first</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="va">year</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>
  <span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">first</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1L</span>
<span class="op">}</span>

<span class="fu">day_of_year</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; Time difference of 185 days</span></code></pre></div>
</div>
</div>
<div id="when-is-the-next-daylight-saving-time-event" class="section level2">
<h2 class="hasAnchor">
<a href="#when-is-the-next-daylight-saving-time-event" class="anchor"></a>When is the next daylight saving time event?</h2>
<p>Given a particular zoned-time, when will it next be affected by daylight saving time? For this, we can use a relatively low level helper, <code><a href="../reference/zoned_info.html">zoned_info()</a></code>. It returns a data frame of information about the current daylight saving time transition points, along with information about the offset, the current time zone abbreviation, and whether or not daylight saving time is currently active or not.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/zoned_parse.html">zoned_parse</a></span><span class="op">(</span><span class="st">"2019-01-01 00:00:00-05:00[America/New_York]"</span><span class="op">)</span>

<span class="va">info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/zoned_info.html">zoned_info</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>

<span class="co"># Beginning of the current DST range</span>
<span class="va">info</span><span class="op">$</span><span class="va">begin</span>
<span class="co">#&gt; &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[1]&gt;</span>
<span class="co">#&gt; [1] "2018-11-04 01:00:00-05:00"</span>

<span class="co"># Beginning of the next DST range</span>
<span class="va">info</span><span class="op">$</span><span class="va">end</span>
<span class="co">#&gt; &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[1]&gt;</span>
<span class="co">#&gt; [1] "2019-03-10 03:00:00-04:00"</span></code></pre></div>
<p>So on 2018-11-04 at (the second) 1 o’clock hour, daylight saving time was turned off. On 2019-03-10 at 3 o’clock, daylight saving time will be considered on again. This is the next moment in time right after a daylight saving time gap of 1 hour, which you can see by subtracting 1 second (in sys-time):</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Last moment in time in the current DST range</span>
<span class="va">info</span><span class="op">$</span><span class="va">end</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/as_sys.html">as_sys</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/clock-arithmetic.html">add_seconds</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/as_zoned.html">as_zoned</a></span><span class="op">(</span><span class="fu"><a href="../reference/zoned-zone.html">zoned_zone</a></span><span class="op">(</span><span class="va">info</span><span class="op">$</span><span class="va">end</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[1]&gt;</span>
<span class="co">#&gt; [1] "2019-03-10 01:59:59-05:00"</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Davis Vaughan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
